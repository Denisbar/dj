<!DOCTYPE html>
<!-- saved from url=(0080)http://bl.ocks.org/jebeck/raw/10699411/780a82f288fa04398a1ccba283547e9c6f8260a9/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <title>
            SVG foreignObject tooltips in D3
        </title>
        <script src="./d3.v3.min.js" charset="utf-8"></script>
        <style type="text/css">
            svg {
                display: block;
                margin: 0 auto;
            }
            .svg-tooltip {
                pointer-events: none;
            }
            .tooltip {
                padding: 10px;
                color: #4A22FF;
            }
            .lead {
                font-style: italic;
            }
            p {
                margin: 5px 0px;
            }
            polygon {
                pointer-events: none;
            }
        </style>
    </head>
    <body marginwidth="0" marginheight="0">
        <script type="text/javascript">
            var margin = {top: 20, right: 10, bottom: 20, left: 10};
            var width = 800 - margin.left - margin.right;
            var height = 480 - margin.top - margin.bottom;
            var svg = d3.select('body')
                .append('svg')
                .attr({
                    'width': width + margin.left + margin.right,
                    'height': height + margin.top + margin.bottom
                })
                .append('g')
                .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');
            svg.append('rect')
                .attr({
                    'width': width * 0.8,
                    'height': height * 0.8,
                    'x': width * 0.1,
                    'y': height * 0.1,
                    'fill': '#F8F8F8'
                });
            var foWidth = 300;
            var anchor = {'w': width/3, 'h': height/3};
            var t = 50, k = 15;
            var tip = {'w': (3/4 * t), 'h': k};
            svg.append('circle')
                .attr({
                    'r': 50,
                    'cx': anchor.w,
                    'cy': anchor.h,
                    'fill': '#7413E8',
                    'opacity': 0.35
                })
                .on('mouseover', function() {
                    var fo = svg.append('foreignObject')
                        .attr({
                            'x': anchor.w - tip.w,
                            'y': anchor.h + tip.h,
                            'width': foWidth,
                            'class': 'svg-tooltip'
                        });
                    var div = fo.append('xhtml:div')
                        .append('div')
                        .attr({
                            'class': 'tooltip'
                        });
                    div.append('p')
                        .attr('class', 'lead')
                        .html('Holmes was certainly not a difficult man to live with.');
                    div.append('p')
                        .html('He was quiet in his ways, and his habits were regular. It was rare for him to be up after ten at night, and he had invariably breakfasted and gone out before I rose in the morning.');
                    var foHeight = div[0][0].getBoundingClientRect().height;
                    fo.attr({
                        'height': foHeight
                    });
                    svg.insert('polygon', '.svg-tooltip')
                        .attr({
                            'points': "0,0 0," + foHeight + " " + foWidth + "," + foHeight + " " + foWidth + ",0 " + (t) + ",0 " + tip.w + "," + (-tip.h) + " " + (t/2) + ",0",
                            'height': foHeight + tip.h,
                            'width': foWidth,
                            'fill': '#D8D8D8', 
                            'opacity': 0.75,
                            'transform': 'translate(' + (anchor.w - tip.w) + ',' + (anchor.h + tip.h) + ')'
                        });
                })
                .on('mouseout', function() {
                    svg.selectAll('.svg-tooltip').remove();
                    svg.selectAll('polygon').remove();
                });
        </script><svg width="800" height="480"><g transform="translate(10,20)"><rect width="624" height="352" x="78" y="44" fill="#F8F8F8"></rect><circle r="50" cx="260" cy="146.66666666666666" fill="#7413E8" opacity="0.35"></circle></g></svg>
    
</body></html>